generator-air â€”â€” æœ‰æ€åº¦ã€æœ‰è´¨é‡ã€æ— é‡é‡çš„è„šæ‰‹æ¶ç”Ÿæˆå™¨ã€‚

[TOC]

# ä¸€ã€è®¾è®¡æ€æƒ³

æˆ‘ä»¬çš„åŸºæœ¬åŸåˆ™ï¼šè½»é‡ã€è½»é‡ã€è½»é‡ã€‚
æˆ‘ä»¬çš„æ€åº¦ï¼šåœ¨ä¿è¯è„šæ‰‹æ¶è½»é‡ã€æ˜“å­¦ä¹ ã€å¥½ä¸Šæ‰‹çš„åŸºæœ¬åŸåˆ™ä¸‹ï¼Œå°½æœ€å¤§å¯èƒ½ä¸ºæ‚¨æä¾›èŠ‚çœå¼€å‘æˆæœ¬çš„å†…ç½®æ¨¡å—ä»¥åŠå„ç§å·¥å…·ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚
æˆ‘ä»¬çš„æ„¿æ™¯ï¼šè®©å¼€å‘è€…ç”¨æœ€ä½çš„å­¦ä¹ æˆæœ¬ï¼Œè·å–æœ€é«˜çš„å¼€å‘æ•ˆç‡ã€‚
æˆ‘ä»¬çš„ç›®æ ‡ï¼šç¡®ä¿ä¸ºæ‚¨æä¾›çš„æ¯ä¸€æ¬¾è„šæ‰‹æ¶ï¼Œéƒ½è¶³å¤Ÿç²¾è‡´ã€‚

<br>

# äºŒã€å¿«é€Ÿä¸Šæ‰‹

## 1.å®‰è£…

```shell
npm install -g generator-air
```

<br>

## 2.ä½¿ç”¨

ä»»æ„ç›®å½•ä¸‹ï¼ˆå¦‚ï¼štmpç›®å½•ï¼‰æ‰§è¡Œï¼š

```shell
yo air
```

<br>

æ ¹æ®æç¤ºï¼ŒæŒ‰éœ€é€‰æ‹©ã€‚

<br>

## 3.å¯åŠ¨æµ‹è¯•

è¿›å…¥åˆšåˆšåˆ›å»ºçš„é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œï¼š

```shell
npm run dev
```

<br>

å‡ºç°ä¸‹å›¾ï¼Œåˆ™å¯åŠ¨æˆåŠŸï¼š

![image](assets/npm_run_dev.png)

<br>

å¯åŠ¨æˆåŠŸåï¼Œæµè§ˆå™¨è®¿é—® localhost:8090

![image](assets/home.png)

<br>

# ä¸‰ã€å„æ¬¾è„šæ‰‹æ¶ä»‹ç»

## Â· ç®¡ç†ç«¯-vueï¼ˆå·²æ”¯æŒï¼‰

### 1.æŠ€æœ¯æ ˆï¼švue + element-ui

<br>

### 2.å¯åŠ¨æ•ˆæœï¼š

![image](assets/home.png)

<br>

### 3.ç›®å½•ç»“æ„ï¼š

```javascript
â”œâ”€â”€ babel.config.js
â”œâ”€â”€ config.js   // é¡¹ç›®æ„å»ºç›¸å…³é…ç½®æ–‡ä»¶ã€‚å¦‚cdnä¸Šä¼ è·¯å¾„ç­‰
â”œâ”€â”€ gulpfile.js
â”œâ”€â”€ package.json
â”œâ”€â”€ public   // é¡µé¢æ¨¡æ¿
|  â”œâ”€â”€ favicon.ico
|  â””â”€â”€ index.html
â”œâ”€â”€ src   // æºä»£ç 
|  â”œâ”€â”€ App.vue          // æ ¹ç»„ä»¶
|  â”œâ”€â”€ assets             // é™æ€èµ„æºæ–‡ä»¶å¤¹ï¼ˆå›¾ç‰‡ã€iconã€cssï¼‰
|  â”œâ”€â”€ components    // è‡ªå®šä¹‰ç»„ä»¶
|  |  â”œâ”€â”€ global         // å…¨å±€ç”¨ç»„ä»¶ï¼ˆlogoã€svgIconç­‰ï¼‰
|  |  â”œâ”€â”€ list             // åˆ—è¡¨é¡µç”¨ç»„ä»¶ï¼ˆtableã€paginationã€searchã€filterï¼‰
|  |  â””â”€â”€ nav           // å¸ƒå±€ç”¨ç»„ä»¶ï¼ˆnavHeadã€navSideï¼‰
|  â”œâ”€â”€ main.js   // ä¸»å…¥å£
|  â”œâ”€â”€ mixin      // è‡ªå®šä¹‰çš„ä¸€äº›æ’ä»¶ï¼Œä¸ºVueå¢åŠ å…¨å±€/åŸå‹æ–¹æ³•
|  â”œâ”€â”€ model     // ç”¨äºå­˜æ”¾ä¸€äº›å­—å…¸ç±»çš„æ–‡ä»¶
|  â”œâ”€â”€ pages      // é¡µé¢ç®¡ç†
|  â”œâ”€â”€ router     // è·¯ç”±é…ç½®
|  â”œâ”€â”€ util         // å­˜æ”¾é¡¹ç›®é€»è¾‘ç”¨çš„å·¥å…·æ–¹æ³•
|  â””â”€â”€ vuex      // vuexä½¿ç”¨demo
â”œâ”€â”€ tools          // ç”¨äºé¡¹ç›®åˆ›å»ºçš„å·¥å…·æ–¹æ³•ï¼ˆå‘½ä»¤è¡Œä½¿ç”¨çš„æ–¹æ³•ã€‚ä¸ºæé«˜å¼€å‘è€…å¼€å‘æ•ˆç‡æä¾›ï¼‰
|  â”œâ”€â”€ answersStore.js
|  â”œâ”€â”€ pageCreate.js   // é¡µé¢åˆ›å»ºå·¥å…·ï¼ˆyarn pageï¼‰
|  â””â”€â”€ routeCreate.js   // è·¯ç”±åˆ›å»ºå·¥å…·ï¼ˆyarn routeï¼‰
â”œâ”€â”€ vue.config.js
â””â”€â”€ yarn.lock
```

<br>

### 4.å¿«é€Ÿå¼€å§‹
#### 4.1 é¡µé¢åˆ›å»º

```shell
yarn page
```

æŒ‰éœ€é€‰æ‹©ï¼š

![image](assets/page_create_1.png)

æ‰§è¡Œç”Ÿæˆåï¼Œæ•ˆæœå¦‚ä¸‹ï¼š

![image](assets/page_create_1.png)

<br>
**ã€æ³¨æ„ç‚¹ã€‘**
æŒ‰ç…§æˆ‘ä»¬çš„è®¾è®¡ï¼Œpages ä¸‹çš„æ–‡ä»¶å¤¹ï¼Œåº”è¯¥ä¸èœå•é¡µä¸€ä¸€å¯¹åº”ã€‚

è¿™é‡Œï¼Œæ¯”å¦‚æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªåˆ—è¡¨é¡µï¼Œå®ƒæ˜¯ä¸€ä¸ªèœå•é¡µã€‚
é‚£ä¹ˆï¼Œé¡µé¢è·¯å¾„åº”è¯¥è¾“å…¥ï¼š**demo/list æˆ– demo/index**ã€‚
**è¯·æ³¨æ„èœå•é¡µçš„å‘½åã€‚å¦‚æœä½ è·Ÿéšæˆ‘ä»¬çš„æ–‡æ¡£ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨ routeCreate ç”Ÿæˆè·¯ç”±ï¼Œé‚£ä¹ˆèœå•é¡µçš„å‘½ååªèƒ½æ˜¯ list.vue / index.vueã€‚**

å¦‚æœè¿™ä¸ªèœå•é¡µä¸Šå­˜åœ¨â€œç¼–è¾‘â€â€œè¯¦æƒ…â€æŒ‰é’®ï¼Œä¹Ÿå°±æ˜¯ï¼Œå­˜åœ¨äºŒçº§é¡µé¢å…¥å£ã€‚
é‚£ä¹ˆï¼Œåœ¨åˆ›å»ºå®ƒä¸‹å±çš„â€œç¼–è¾‘â€â€œè¯¦æƒ…â€é¡µæ—¶ï¼Œä½ åº”è¯¥è¿™æ ·å®šä¹‰é¡µé¢è·¯å¾„ï¼šdemo/editã€demo/detailã€‚

<br>
å½“ä½ æŠŠéœ€è¦çš„æ‰€æœ‰é¡µé¢éƒ½åˆ›å»ºå®Œæˆï¼Œå°±å¯ä»¥æ‰§è¡Œä¸‹ä¸€æ­¥ï¼Œæ„‰å¿«åœ°è¿›è¡Œè·¯ç”±çš„è‡ªåŠ¨ç”Ÿæˆå•¦~
å½“ç„¶ï¼Œå¦‚æœåé¢è¿˜æœ‰æ–°å¢çš„é¡µé¢ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºåï¼Œå†æ¬¡æ‰§è¡Œè·¯ç”±çš„ç”Ÿæˆå“¦ ğŸ˜‰

<br>

#### 4.2 è·¯ç”±ç”Ÿæˆ

```shell
yarn route
```

![image](assets/route_create.png)

<br>
æŒ‰ç…§æˆ‘ä»¬å½“å‰æ¨¡æ‹Ÿçš„åœºæ™¯ï¼Œè¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡åˆ›å»ºè·¯ç”±ã€‚å› æ­¤ï¼Œé€‰æ‹©è¦†ç›–/ä¸è¦†ç›–ï¼Œçš†å¯ã€‚
æ‰§è¡Œåï¼Œä½ ä¼šå¾—åˆ°ä¸ pages ä¸‹æ–‡ä»¶å¤¹ä¸€ä¸€å¯¹åº”çš„æ‰€æœ‰è·¯ç”±æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯ï¼Œä¸èœå•é¡µä¸€ä¸€å¯¹åº”ã€‚
<br>

ä»¥å†…ç½® demo ä¸ºä¾‹ã€‚pages æ–‡ä»¶å¤¹ç»“æ„å¦‚ä¸‹ï¼š

![image](assets/pages.png)

routeCreate ç”Ÿæˆçš„è·¯ç”±æ–‡ä»¶å¦‚ä¸‹ï¼š

![image](assets/router.png)

<br>

ã€æ³¨æ„ç‚¹ã€‘
ï¼ˆ1ï¼‰routeCreate ä¸ä¼šå¤„ç†ç›´æ¥åˆ›å»ºåœ¨ pages ä¸‹çš„é¡µé¢ã€‚è¿™äº›é¡µé¢çš„è·¯ç”±ï¼Œéœ€è¦å¼€å‘è€…åœ¨ router/index.js ä¸­æ‰‹åŠ¨å®šä¹‰ã€‚å¦‚å†…ç½®çš„ home.vueã€notFound.vue é¡µé¢ã€‚

ï¼ˆ2ï¼‰æ ¹æ®æˆ‘ä»¬çš„è®¾è®¡ï¼Œ**æ¯ä¸€ä¸ªèœå•é¡µï¼Œå›ºå®šä¸ºä¸€å±‚è·¯ç”±**ï¼Œå¯¹åº” pages ä¸‹çš„æ–‡ä»¶å¤¹åç§°ã€‚è¿™ä¸ªè·¯ç”±ä½œä¸ºä¸€ä¸ª**å‘½åç©ºé—´**ï¼Œç”¨äºèœå•æ çš„é€‰ä¸­æ€åˆ¤æ–­ã€‚

<br>
** å¦‚æœä½ ä¸æƒ³ä½¿ç”¨æˆ‘ä»¬çš„ routeCreateï¼Œè€Œé€‰æ‹©æ‰‹åŠ¨åˆ›å»ºè·¯ç”±ï¼Œé‚£ä¹ˆä½ éœ€è¦éµå¾ªä»¥ä¸‹ä¸¤ç‚¹è§„èŒƒï¼š
ï¼ˆ1ï¼‰èœå•é¡µçš„è·¯ç”±ï¼Œå®šä¹‰ä¸ºä¸€ä¸ªå‘½åç©ºé—´ã€‚æ¯”å¦‚ï¼š/demoï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ /demo/indexã€‚
ï¼ˆ2ï¼‰èœå•é¡µçš„ä¸‹çº§é¡µé¢è·¯ç”±ï¼Œåœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸‹è¿½åŠ ã€‚æ¯”å¦‚ï¼šäºŒçº§é¡µé¢ /demo/editï¼Œä¸‰çº§é¡µé¢ /demo/edit/previewã€‚æˆ–äºŒçº§é¡µé¢ /demo/index/editï¼Œä¸‰çº§é¡µé¢ /demo/index/edit/preview **

<br>

#### 4.3 èœå•å®šä¹‰

```javascript
// model/menu.js â€”â€” æ ¹æ®å¦‚ä¸‹å†…ç½®ç¤ºä¾‹ï¼Œé…ç½®é¡¹ç›®çš„èœå•
const menus = [
	{
		title: 'æ“ä½œè¿‡æ»¤',
		icon: 'clock',
		url: '/demo1'
	},
	{
		title: 'å·¥å…·ç¤ºä¾‹',
		icon: 'gear',
		submenu: [
			{
				title: 'ä½¿ç”¨ç¤ºä¾‹',
				url: '/demo2'
			}
		]
	},
	{
		title: 'ç»„ä»¶ç¤ºä¾‹',
		icon: 'clock',
		submenu: [
			{
				title: 'æ•°æ®ç®¡ç†',
				icon: 'clock',
				submenu: [
					{
						title: 'æ•°æ®åˆ—è¡¨',
						url: '/demo3'
					}
				]
			}
		]
	},
]

export default menus

```

**ã€æ³¨æ„ç‚¹ã€‘**

æˆ‘ä»¬å·²ç»åˆ›å»ºå®Œæ‰€æœ‰è·¯ç”±ï¼Œè¿™é‡Œï¼Œä½ åªéœ€å» router ä¸‹çš„è·¯ç”±æ–‡ä»¶ä¸­ï¼Œå¯»æ‰¾ä½ éœ€è¦çš„èœå•é¡µè·¯ç”±ï¼Œå¹¶é…ç½®åœ¨ model/menu.js ä¸­å³å¯ã€‚

<br>
#### 4.4 æƒé™å­—å…¸

å®šä¹‰æƒé™å­—å…¸ï¼ˆmodel/authDictï¼‰ï¼š

```javascript
const dictionary = {
	// 101ï¼šè§’è‰²idï¼ˆroleIdï¼‰
	101: [
		{
			path: '/demo1',   // æœ‰æƒè®¿é—®çš„è·¯ç”±
			operations: ['create', 'edit', 'delete']   // å¯¹å½“å‰è·¯ç”±æœ‰æƒè¿›è¡Œçš„æ“ä½œ
		},
		{
			path: '/demo2',
			operations: ['create', 'edit']
		},
		{
			path: '/demo3',
			operations: ['create', 'edit', 'delete']
		},
		{
			path: '/demo3/edit',
			operations: ['create', 'edit']
		},
		{
			path: '/demo3/detail',
			operations: ['delete']
		}
	],
	102: [
		{
			path: '/demo1/edit',
			operations: ['edit', 'delete']
		},
		{
			path: '/demo2'
		}
	]
}

export default dictionary;

```

**ã€æ³¨æ„ç‚¹ã€‘**

ï¼ˆ1ï¼‰roleId ä»è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£æ‹¿åˆ°ã€‚è¯·è‡ªè¡Œä¸åå°åŒå­¦å¯¹æ¥ç¡®è®¤ã€‚
ï¼ˆ2ï¼‰operations å­—æ®µå¯é€‰ã€‚å¦‚æœä¸éœ€è¦è¿›è¡Œé¡µé¢æ“ä½œæƒé™æ§åˆ¶ï¼Œåˆ™å¯ä»¥ä¸å®šä¹‰ operationsã€‚
ï¼ˆ3ï¼‰operations æ•°ç»„çš„å­—æ®µå€¼ï¼Œç”±å¼€å‘è€…è‡ªè¡Œå®šä¹‰

<br>
#### 4.5 api.js æ¥å£å®šä¹‰

model/api.jsï¼š

```javascript
// ç»Ÿä¸€çš„æ¥å£ç®¡ç†
const API = {
	getUserInfo: '/getUserInfo'
}

// å¦‚æœæ˜¯å¼€å‘æ¨¡å¼ï¼Œä¸ºæ¥å£è·¯å¾„æ‰‹åŠ¨æ·»åŠ devå‰ç¼€ï¼Œç”¨äºproxyä»£ç†åŒ¹é…
if (document.domain.indexOf('.com') === -1) {
	Object.keys(API).forEach(key => {
		API[key] = '/dev' + API[key]
	})
}

export default API
```

éœ€è¦è°ƒç”¨çš„åå°æ¥å£ï¼Œç»Ÿä¸€åœ¨ api.js é‡Œå®šä¹‰ã€‚å¹¶åœ¨é¡µé¢ä¸­ï¼Œé€šè¿‡å¼•ç”¨ api.js è¿›è¡Œè°ƒç”¨ã€‚

<br>
#### 4.6 æƒé™æ§åˆ¶

è·¯ç”±ä¸èœå•çš„æƒé™æ§åˆ¶é€»è¾‘ï¼Œè„šæ‰‹æ¶å·²ç»å†…ç½®ã€‚
å› æ­¤ï¼Œå¯¹äºæƒé™æ§åˆ¶ï¼Œä½ åªéœ€è¦æŒ‰éœ€è¿›è¡Œé¡µé¢æ“ä½œæƒé™çš„è¿‡æ»¤æ“ä½œå³å¯ã€‚
<br>

è„šæ‰‹æ¶å†…ç½®çš„æƒé™å¤„ç†ï¼ˆrouter/index.jsï¼‰ï¼š

```javascript
import $vue from 'vue'
import $vueRouter from 'vue-router'
import $Auth from 'authority-filter'  // npm åŒ…
import $request from '.mixin/request'
import $authDic from '.model/authDict'
import $demo1 from 'demo1'
import $demo2 from 'demo2'
import $demo3 from 'demo3'
import $allMenus from '.model/menu'
import $store from '.vuex/index'
import $api from '.model/api'

const $home = () => import(/* webpackChunkName: "home" */ 'pages/home')
const $notFound = () => import(/* webpackChunkName: "notFound" */ 'pages/notFound')

$vue.use($vueRouter)

const router = new $vueRouter()

// æ‹‰å–ç”¨æˆ·ä¿¡æ¯ï¼ˆã€Replaceã€‘éœ€æ›¿æ¢ä¸ºå®é™…çš„æ¥å£åœ°å€ï¼‰
$request.$get($api.getUserInfo).then(res => {
	if (res && res.data) {
		// å…¨å±€å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
		$store.commit('user/setUserInfo', res.data)
		// å°†æƒé™å­—å…¸ + roleIdä¼ å…¥æƒé™ç»„ä»¶
		const auth = new $Auth($authDic, res.data.roleId)
		// å…¨å±€å­˜å‚¨ auth å¯¹è±¡
		$store.commit('user/setAuth', auth)
		// è·å–ç»è¿‡æƒé™è¿‡æ»¤åçš„è·¯ç”±
		const routerList = auth.getRouterList([...$demo1, ...$demo2, ...$demo3])
		router.addRoutes([
			...routerList,
			{
				path: '/',
				redirect: '/home'
			},
			{
				path: '/home',
				component: $home
			},
			{
				path: '*',
				component: $notFound
			}
		])
		// è·å–ç»è¿‡æƒé™è¿‡æ»¤åçš„èœå•
		const menuList = auth.getMenuList($allMenus)
		// æƒé™è¿‡æ»¤åçš„èœå•ä¿å­˜è‡³vuex
		$store.commit('menu/setMenu', menuList)
	}
})
```

<br>
å¯¹é¡µé¢çš„æ“ä½œæƒé™è¿›è¡Œè¿‡æ»¤ï¼Œè¯·å‚è€ƒ pages/demo1/list.vueï¼š

```html
<template lang="pug">
	.p-page
		.title é¡µé¢æ“ä½œè¿‡æ»¤demo
		.buttons
			//- è¿™é‡Œè¯»å–çš„å­—æ®µï¼Œå–å†³äº authDict.js å†…çš„å®šä¹‰
			el-button(v-if="operations.includes('create')") åˆ›å»º
			el-button(v-if="operations.includes('edit')") ç¼–è¾‘
			el-button(v-if="operations.includes('delete')") åˆ é™¤
</template>

<script>
import { mapState } from 'vuex'

export default {
	computed: {
		...mapState('user', [
			'auth'
		])
	},
	data() {
		return {
			operations: []
		}
	},
	methods: {

	},
	mounted() {
		this.operations = this.auth.getPageOperations(this.$route.path)
	}
}
</script>

<style lang="less">
.p-page {
	.title {
		margin-bottom: 20px;
	}
}
</style>

```

<br>

#### 4.7 ç™»å½•é€»è¾‘
#### 4.7.1 ç¬¬ä¸‰æ–¹ç™»å½•

æˆ‘ä»¬å·²ç»åœ¨ router/index.js ä¸­ä¸ºä½ å†™å¥½äº†ç™»å½•ã€æƒé™çš„æ§åˆ¶é€»è¾‘ã€‚å…·ä½“é€»è¾‘ï¼Œå¯é˜…è¯» [æ­¤å¤„](#51-%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90 "æ­¤å¤„")ã€‚

è¿™é‡Œä½ éœ€è¦åšçš„ï¼Œåªæ˜¯é…ç½®ä¸€ä¸‹ model/errorDict.jsï¼Œå†™æ˜ç¬¬ä¸‰æ–¹ç™»å½•çš„è·³è½¬åœ°å€å³å¯ã€‚

æ¯”å¦‚ï¼ŒhttpCode 403ï¼Œå¹¶ä¸”åå°è¿”å›é”™è¯¯ç  code: 3000 æ—¶ï¼Œéœ€è¦è·³è½¬åˆ°ç™»å½•é¡µã€‚é‚£ä¹ˆä½ éœ€è¦è¿™æ ·é…ç½®ï¼š

```javascript
export default {
	403: {
		3000: () => location.href = 'http://mp.weixin.qq.com'
	}
}

```

<br>

#### 4.7.2 æœ¬ç³»ç»Ÿç™»å½•ï¼ˆå¼€å‘å®Œå–„ä¸­ï¼‰

#### 4.8 è¯·æ±‚é”™è¯¯ç å­—å…¸ï¼ˆerrorDictï¼‰é…ç½®
é™¤ç™»å½•åœºæ™¯å¤–ï¼Œä½ è¿˜å¯ä»¥é…ç½®å…¶ä»–éœ€è¦å‰ç«¯ç‰¹æ®Šå¤„ç†çš„é”™è¯¯åœºæ™¯ã€‚å…·ä½“é…ç½®æ–¹æ³•ï¼Œå¯é˜…è¯» [æ­¤å¤„](#533-%E8%AF%B7%E6%B1%82%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86 "æ­¤å¤„")ã€‚

<br>

#### 4.9 å¯åŠ¨æ—¥å¿—ç›‘æ§

ï¼ˆ1ï¼‰ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œé¡¹ç›®
åˆ° aegis.ivweb.io æ³¨å†Œï¼Œè·å–é¡¹ç›® idã€‚
<br>

ï¼ˆ2ï¼‰ç¬¬äºŒæ­¥ï¼šå°†é¡¹ç›® id æ·»åŠ åˆ° aegis ä¸­
mixin/aegis.jsï¼š

```javascript
aegis = new Aegis({
	id: 'xxx', // åœ¨ aegis.qq.com ç”³è¯·åˆ°çš„ id
})
```
<br>

ï¼ˆ3ï¼‰ç¬¬ä¸‰æ­¥ï¼šå¯ç”¨æ—¥å¿—ç›‘æ§
config.jsï¼š

```javascriptt
config.logReport = true // æ—¥å¿—å…¨å±€å¼€å…³
```
<br>

ï¼ˆ4ï¼‰åœ¨éœ€è¦ç›‘æ§çš„é¡µé¢ä¸Šè°ƒç”¨ï¼š

```javascript
this.$aegis.logI('ä¸ŠæŠ¥æ™®é€šæ—¥å¿—', report)
this.$aegis.logE('ä¸ŠæŠ¥é”™è¯¯æ—¥å¿—', report)
this.$aegis.report('ä¸ŠæŠ¥æµ‹é€Ÿæ—¥å¿—', report)
```
<br>

#### 4.10 å¯åŠ¨å¼€å‘

```shell
yarn dev
```

è¿™é‡Œï¼Œè¯»å– mock æ¥å£ã€‚
<br>

#### 4.11 å¯åŠ¨è”è°ƒ

```shell
yarn debug
```

è¿™é‡Œï¼Œè¯»å–è”è°ƒæ¥å£ã€‚
<br>

#### 4.12 é¡¹ç›®éƒ¨ç½²

ï¼ˆ1ï¼‰cos ä¿¡æ¯é…ç½®

```javascript
const $urlJoin = require('url-join')
// ä½¿ç”¨ COS çš„åŸŸåï¼Œä»¥//å¼€å¤´ï¼Œè‡ªåŠ¨åŒ¹é…ç«™ç‚¹åè®®
config.cdnBase = '//cdn.xx.yy.com'
// COS ä¸Šä¼ çš„è·¯å¾„
config.uploadUrl = '/2019/test-project'
config.cdnRoot = $urlJoin(config.cdnBase, config.uploadUrl)
// COS ä¸Šä¼ é…ç½®æ¨¡æ¿
config.uploadConfig = {
	// åœ¨è…¾è®¯äº‘ç”³è¯·çš„ AppId
	AppId: '',
	// é…ç½®è…¾è®¯äº‘ COS æœåŠ¡æ‰€éœ€çš„ SecretId
	SecretId: '',
	// é…ç½®è…¾è®¯äº‘ COS æœåŠ¡æ‰€éœ€çš„ SecretKey
	SecretKey: '',
	// COSæœåŠ¡é…ç½®çš„å­˜å‚¨æ¡¶åç§°
	Bucket: '',
	// åœ°åŸŸåç§°
	Region: '',
	// ä¸Šä¼ cdnçš„è·¯å¾„ã€‚æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°è¿™ä¸ªè·¯å¾„ä¸‹
	prefix: config.uploadUrl
}
```

ï¼ˆ2ï¼‰æ‰“åŒ…

```shell
yarn build
```

ï¼ˆ3ï¼‰é™æ€èµ„æºä¸Šä¼ 

```shell
yarn upload
```

ï¼ˆ4ï¼‰æ‰§è¡Œéƒ¨ç½²

é€šè¿‡ scp ç­‰å‘½ä»¤ï¼Œå°†æ‰“åŒ…åçš„ index.html ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚

ï¼ˆ5ï¼‰å®Œæˆ

<br>

### 5.åŠŸèƒ½æ¨¡å—è¯¦è§£

#### 5.1 ç”¨æˆ·æƒé™

#### 5.1.1 ç¬¬ä¸‰æ–¹ç™»å½•åœºæ™¯

ï¼ˆ1ï¼‰æ•´ä½“æµç¨‹

![image](assets/login_flow.png)

<br>

ï¼ˆ2ï¼‰ç”¨æˆ·ä¿¡æ¯ç®¡ç†

ç”¨æˆ·ä¿¡æ¯å­˜æ”¾äºvuexä¸­ï¼ˆvuex/user.jså¦‚ä¸‹ï¼‰ï¼š

```javascript
export default {
	state: {
		userInfo: null,
		auth: null
	},
	mutations: {
		setUserInfo (state, info) {
			state.userInfo = info
		},
		setAuth (state, authObj) {
			state.auth = authObj
		}
	}
}
```

<br>

ï¼ˆ3ï¼‰æƒé™ç®¡ç†

**ã€å®ç°æ–¹æ¡ˆã€‘**
ä½¿ç”¨ authority-filter å·¥å…·åŒ…ï¼Œè¿›è¡Œèœå•ã€è·¯ç”±ã€é¡µé¢æ“ä½œï¼Œä¸‰ä¸ªç»´åº¦çš„æƒé™æ§åˆ¶ã€‚

<br>

**ã€å®ç°ä»£ç ã€‘**

```javascript
// router/index.js
import $Auth from 'authority-filter'
import $authDic from '.model/authDict'
import $demo1 from 'demo1'
import $demo2 from 'demo2'
import $demo3 from 'demo3'
import $allMenus from '.model/menu'

// $authDic æ˜¯éœ€è¦å¼€å‘è€…è‡ªè¡Œå®šä¹‰çš„æƒé™å­—å…¸ã€‚roleId æ˜¯ä» userInfo ä¸­è·å–çš„ç”¨æˆ·è§’è‰² id
const auth = new $Auth($authDic, roleId)
// å…¨å±€å­˜å‚¨ auth å¯¹è±¡ï¼ˆæˆ‘ä»¬å»ºè®®è¿™æ ·åšã€‚å¦‚æœæœ‰é¡µé¢æ“ä½œæƒé™æ§åˆ¶éœ€æ±‚ï¼Œé‚£ä¹ˆå¿…é¡»è¿™æ ·åšï¼‰
$store.commit('user/setAuth', auth)
// è¿›è¡Œè·¯ç”±è¿‡æ»¤ï¼ˆä¼ å…¥é¡¹ç›®å®šä¹‰çš„æ‰€æœ‰è·¯ç”±ã€‚è¯¦è§ 5.2ï¼‰
const routerList = auth.getRouterList([...$demo1, ...$demo2, ...$demo3])
// ç”Ÿæˆå½“å‰ç”¨æˆ·æœ‰æƒè®¿é—®çš„è·¯ç”±é…ç½®ã€‚å…¶ä¸­ï¼Œ'/' '/home' '*' ä¸ºé»˜è®¤è·¯ç”±é…ç½®ï¼Œæ‰€æœ‰ç”¨æˆ·çš†æœ‰æƒé™è®¿é—®
router.addRoutes([
	...routerList,
	{
		path: '/',
		redirect: '/home'
	},
	{
		path: '/home',
		component: $home
	},
	{
		path: '*',
		component: $notFound
	}
])
// è¿›è¡Œèœå•è¿‡æ»¤ï¼ˆä¼ å…¥é¡¹ç›®å®šä¹‰çš„æ‰€æœ‰èœå•ã€‚è¯¦è§ 5.2ï¼‰
const menuList = auth.getMenuList(allMenus)
// å…¨å±€å­˜å‚¨ menuListï¼ˆè¿™é‡Œå…¨å±€å­˜å‚¨ï¼Œåœ¨ç”Ÿæˆèœå•æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡vuexè®¿é—®åˆ°menuListæ•°æ®ï¼‰
$store.commit('menu/setMenu', menuList)
```

å…³äº authority-filter çš„è¯¦ç»†è¯´æ˜ï¼Œè¯·å‚ç…§ï¼š[authority-filter](https://www.npmjs.com/package/authority-filter "authority-filter")

<br>

#### 5.1.2 æœ¬ç³»ç»Ÿç™»å½•åœºæ™¯ï¼ˆå¼€å‘å®Œå–„ä¸­ï¼‰
ï¼ˆ1ï¼‰æ•´ä½“æµç¨‹
ï¼ˆ2ï¼‰ç”¨æˆ·ä¿¡æ¯ç®¡ç†
ï¼ˆ3ï¼‰æƒé™ç®¡ç†

#### 5.2 èœå•&è·¯ç”±&é¡µé¢

#### 5.2.1 èœå•çš„è®¾è®¡

å®šä¹‰ä½ç½®ï¼šmodel/menu.js ğŸ‘‡

```javascript
const menus = [
	{
		title: 'æ“ä½œè¿‡æ»¤',
		icon: 'clock',
		url: '/demo1'
	},
	{
		title: 'å·¥å…·ç¤ºä¾‹',
		icon: 'gear',
		submenu: [
			{
				title: 'ä½¿ç”¨ç¤ºä¾‹',
				url: '/demo2'
			}
		]
	},
	{
		title: 'ç»„ä»¶ç¤ºä¾‹',
		icon: 'clock',
		submenu: [
			{
				title: 'æ•°æ®ç®¡ç†',
				icon: 'clock',
				submenu: [
					{
						title: 'æ•°æ®åˆ—è¡¨',
						url: '/demo3'
					}
				]
			}
		]
	},
]

export default menus

```

**ã€æ³¨æ„ã€‘**
æ ¹æ®æˆ‘ä»¬çš„è®¾è®¡ï¼Œ**èœå•çš„ urlï¼Œåº”è¯¥åªæœ‰ä¸€å±‚**ã€‚å³ï¼šå®šä¹‰ä¸º/demoï¼Œè€Œé/demo/listã€‚

**è¿™ä¸€å±‚ï¼Œä½œä¸ºä¸€ä¸ªå‘½åç©ºé—´ã€‚å®ƒä¹‹ä¸‹çš„æ‰€æœ‰è·¯å¾„ï¼Œå¯¹åº”è¿™ä¸ªèœå•ä¸‹çš„äºŒçº§ã€ä¸‰çº§...nçº§é¡µé¢ã€‚**
æ¯”å¦‚ï¼Œ/demo æ˜¯ä¸€ä¸ªèœå•é¡µï¼Œç±»å‹ä¸ºåˆ—è¡¨é¡µã€‚åŒ…å«ç¼–è¾‘ã€è¯¦æƒ…æŒ‰é’®ã€‚ä»è¿™ä¸ªå…¥å£è¿›å…¥çš„ç¼–è¾‘ã€è¯¦æƒ…é¡µï¼Œå¯¹åº”çš„è·¯ç”±ï¼Œåº”è¯¥å½¢å¦‚ï¼š/demo/editã€/demo/detailã€‚
è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è·¯ç”±çš„â€œå‘½åç©ºé—´â€ï¼Œç¡®å®šèœå•æ ä¸­çš„å“ªä¸€ä¸ªèœå•ï¼Œæ˜¾ç¤ºä¸ºé«˜äº®é€‰ä¸­ã€‚

<br>

#### 5.2.2 è·¯ç”±çš„è®¾è®¡

é¡¹ç›®ä¸­æ‰€æœ‰è·¯ç”±ï¼Œç»Ÿä¸€æ”¾åœ¨ router æ–‡ä»¶å¤¹ä¸‹ã€‚
routerä¸‹çš„æ¯ä¸€ä¸ªè·¯ç”±æ–‡ä»¶ï¼Œ**ä¸èœå•é¡µä¸€ä¸€å¯¹åº”**ã€‚ä¹Ÿå°±æ˜¯ï¼Œ**ä¸å‘½åç©ºé—´ä¸€ä¸€å¯¹åº”**ã€‚
æ¯ä¸€ä¸ªè·¯ç”±æ–‡ä»¶å†…ï¼Œå®šä¹‰å½“å‰èœå•é¡µã€ä»¥åŠå®ƒä¸‹å±çš„äºŒçº§ã€ä¸‰çº§......nçº§é¡µé¢çš„æ‰€æœ‰è·¯ç”±ã€‚
åœ¨å…¥å£æ–‡ä»¶ router/index.js ä¸­ï¼Œå¼•å…¥ vue-routerï¼Œå’Œæ‰€æœ‰çš„è·¯ç”±æ–‡ä»¶ã€‚åŒæ—¶ï¼Œæ ¹æ®å½“å‰ç™»å½•ç”¨æˆ·æƒé™ï¼ŒåŠ¨æ€ç”Ÿæˆå¯è®¿é—®çš„è·¯ç”±æ–‡ä»¶ã€‚

ä¾‹å¦‚ï¼š
æœ‰èœå•é¡µ/demo1ï¼Œå‘½åç©ºé—´ä¸ºdemo1ï¼Œåˆ™åº”æœ‰ä¸€ä¸ªrouter/demo1.jsï¼Œå†…å®¹å½¢å¦‚ï¼š

```javascript
const pages_demo1_detail = () => import('pages/demo1/detail.vue')
const pages_demo1_edit = () => import('pages/demo1/edit.vue')
const pages_demo1_list = () => import('pages/demo1/list.vue')

const routerList = [
	{
		path: '/demo1/detail',
		component: pages_demo1_detail
	},
	{
		path: '/demo1/edit',
		component: pages_demo1_edit
	},
	{
		path: '/demo1',
		component: pages_demo1_list
	}
]

export default routerList
```

<br>

#### 5.2.3 é¡µé¢çš„ç®¡ç†

æ‰€æœ‰é¡µé¢ï¼Œç»Ÿä¸€å­˜æ”¾åœ¨ pages æ–‡ä»¶å¤¹ä¸‹ã€‚
æŒ‰ç…§æˆ‘ä»¬çš„è®¾è®¡ï¼Œ**pages ä¸‹çš„æ¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¯¹åº”ä¸€ä¸ªèœå•é¡µ**ï¼Œå†…éƒ¨å­˜æ”¾èœå•é¡µ.vueæ–‡ä»¶ï¼Œå’Œå®ƒä¸‹å±çš„æ‰€æœ‰äºŒçº§ã€ä¸‰çº§......nçº§é¡µé¢ã€‚é‚£äº›æ—¢ä¸æ˜¯èœå•é¡µï¼Œåˆä¸æ˜¯èœå•é¡µä¸‹å±é¡µé¢çš„é¡µé¢ï¼Œå¦‚ home é¡µã€notFound é¡µï¼Œç›´æ¥å­˜æ”¾åœ¨ pages ä¸‹ã€‚

**è¿™é‡Œéœ€è¦æ³¨æ„ï¼šèœå•é¡µå¯¹åº”çš„é¡µé¢ï¼Œæˆ‘ä»¬è§„å®šå‘½åä¸º index.vue / list.vueã€‚**

å¦‚æœä½ çš„ pages ç›®å½•ç»“æ„ï¼Œéµä»æˆ‘ä»¬çš„è§„èŒƒï¼Œå½“ä½ ä½¿ç”¨æˆ‘ä»¬æä¾›çš„ yarn route å‘½ä»¤ï¼Œæˆ‘ä»¬ä¼šä¸ºä½ å…¨è‡ªåŠ¨ç”Ÿæˆ router æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰è·¯ç”±æ–‡ä»¶ã€‚

å½“ç„¶ï¼Œè¿™é‡Œçš„è§„èŒƒè¦æ±‚ï¼Œç›®å‰åªæœ‰ä¸¤ç‚¹ï¼š
ï¼ˆ1ï¼‰pages ä¸‹çš„æ¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¦å¯¹åº”ä¸€ä¸ªèœå•é¡µã€‚è¿™ä¸ªæ–‡ä»¶å¤¹çš„åå­—ï¼Œä¼šæˆä¸ºèœå•é¡µçš„è·¯ç”±ï¼Œä¹Ÿå°±æ˜¯å‘½åç©ºé—´ã€‚
ï¼ˆ2ï¼‰èœå•é¡µå¯¹åº”é¡µé¢çš„å‘½åï¼Œåªèƒ½æ˜¯ index.vue / list.vueã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œä½ å¯ä»¥å®Œå…¨æŒ‰ç…§è‡ªå·±çš„æ„æ„¿ï¼Œå»ç®¡ç†é¡µé¢ã€‚
**è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åªä¼šç”Ÿæˆä¸ç›´æ¥å­˜æ”¾äº pages ä¸‹çš„é¡µé¢å¯¹åº”çš„è·¯ç”±æ–‡ä»¶ã€‚**

é‚£äº›ç›´æ¥æ”¾åœ¨ pages ä¸‹çš„é¡µé¢ï¼Œå¦‚ home.vueï¼Œæˆ‘ä»¬é€‰æ‹©åœ¨ router/index.js ä¸­æ‰‹åŠ¨é…ç½®ã€‚
ä¸€æ¥ï¼Œå› ä¸ºè¿™æ ·çš„é¡µé¢å¹¶ä¸ä¼šå¤ªå¤šã€‚äºŒæ¥ï¼Œè¿™æ ·çš„é¡µé¢ï¼Œé€šå¸¸ä¸å­˜åœ¨è®¿é—®æƒé™çš„é—®é¢˜ï¼Œæ‰€æœ‰äººçš†å¯è®¿é—®ï¼Œä¸éœ€è¦å‚ä¸è·¯ç”±è¿‡æ»¤ã€‚åŒæ—¶ï¼Œå¦‚åŒ¹é…'*'çš„notFoundé¡µï¼Œæ˜¯æœ‰å®šä¹‰é¡ºåºè¦æ±‚çš„ï¼Œä¸€å®šè¦æ”¾åˆ°è·¯ç”±å®šä¹‰çš„æœ€åï¼Œæ‰å¯ä»¥é˜²æ­¢é”™è¯¯åŒ¹é…ä¸è·³è½¬ã€‚å› æ­¤ï¼Œæ›´é€‚åˆæ‰‹åŠ¨ç®¡ç†ã€‚

<br>

#### 5.3 æ¥å£è°ƒç”¨ â€”â€” mixin/request.js

#### 5.3.1 ä½¿ç”¨demo

```html
<!-- list.vue -->
<template>
	æˆ‘æ˜¯åˆ—è¡¨é¡µ
</template>

<srcipt>
export default {
	data() {
		return {
			list: ''
		}
	},
	mounted() {
		this.$get('/getList', { age: 25 }).then(res => {
			console.log('res:', res)
			this.setData()
		})
	}
}
</srcipt>
```

<br>

#### 5.3.2 æ”¯æŒåŠŸèƒ½

| æ–¹æ³• | è°ƒç”¨æ–¹å¼ |
| ------------ | ------------ |
| $get | this.$get(url, params).then(rs => console.log('res:', res)) |
| $post | this.$post(url, params).then(rs => console.log('res:', res))|
| $put | this.$put(url, params).then(rs => console.log('res:', res))|
| $delete | this.$delete(url, params).then(rs => console.log('res:', res))|
| $request | this.$request({ method: 'get', params: { test: 100 } }).then(rs => console.log('res:', res))|

ã€æ³¨ã€‘
æ‰€æœ‰æ–¹æ³•ï¼Œå‡æ”¯æŒåœ¨.vueä¸­ç›´æ¥ä½¿ç”¨thisè°ƒç”¨ã€‚
å¦‚æœéœ€è¦åœ¨jsä¸­ä½¿ç”¨ï¼Œæ‰‹åŠ¨importå³å¯ã€‚import { $get, $request } from '@/mixin/request'

<br>

#### 5.3.3 è¯·æ±‚é”™è¯¯å¤„ç†

å¯¹äºè¯·æ±‚é”™è¯¯çš„å¤„ç†ï¼Œæˆ‘ä»¬è®¾è®¡äº†é”™è¯¯å­—å…¸ï¼šmodel/errorDict.jsã€‚

å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```javascript
export default {
	/** key: httpCode
	 *   value: æŒ‡å®šé”™è¯¯ç ï¼Œå¯¹åº”çš„å‰ç«¯å“åº”ã€‚å¦‚æœæ˜¯æ–¹æ³•ï¼Œç›´æ¥æ‰§è¡Œã€‚å¦‚æœæ˜¯stringï¼Œå¼¹çª—æç¤º
	 */
	403: () => location.href = 'http://mp.weixin.qq.com',
	404: 'å•Šå“¦ï¼Œ404äº†',
	200: {
		// key: æœåŠ¡å™¨å®šä¹‰çš„codeï¼Œvalueï¼šåŒä¸Š
		3000: 'æœåŠ¡å™¨è¿”å›äº†ä¸€ä¸ª3000',
		3005: () => location.href = 'https://open.work.weixin.qq.com/wwopen/sso/qrConnect?appid=APPID&agentid=AGENTID&redirect_uri=REDIRECT_URI&'
	}
}

```

å¼€å‘è€…å¯ä»¥é€šè¿‡é…ç½® errorDictï¼ŒæŒ‡å®šé”™è¯¯ç å¯¹åº”çš„å“åº”æˆ–æç¤ºè¯­ã€‚

æˆ‘ä»¬åœ¨request.jsä¸­ä½¿ç”¨äº†æ‹¦æˆªå™¨ï¼Œå¤„ç†errorDictä¸­å®šä¹‰çš„å“åº”ã€‚ä½ å¯ä»¥æ”¾å¿ƒåœ°å°†æ‰€æœ‰é”™è¯¯å¤„ç†ï¼Œç»Ÿä¸€é…ç½®åœ¨è¿™ä¸ªå­—å…¸ä¸­ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåªä¸“æ³¨äºæ•°æ®æ­£ç¡®å“åº”çš„é€»è¾‘å¼€å‘å³å¯ã€‚

<br>

#### 5.4 æ—¥å¿—ç›‘æ§æ¨¡å— â€”â€” Aegis

#### ç®€ä»‹

Aegisæ˜¯è…¾è®¯å¼€æºçš„ä¸€ç«™å¼å‰ç«¯ç›‘æ§è§£å†³æ–¹æ¡ˆï¼Œæ¶µç›–äº†æ—¥å¿—ä¸ŠæŠ¥ï¼Œé”™è¯¯ç›‘æ§ï¼Œæ€§èƒ½ç›‘æ§ï¼Œèµ„æºæµ‹é€Ÿç­‰åŠŸèƒ½ã€‚
ä¸»è¦æä¾›åŸºç¡€æ•°æ®çš„ä¸ŠæŠ¥ï¼Œæ”¯æŒæ— æ‰“ç‚¹é¦–å±æµ‹é€Ÿã€æ— ä¾µå…¥å¼èµ„æºæµ‹é€Ÿã€CGIæµ‹é€Ÿã€ç™½åå•æœºåˆ¶ã€ç¦»çº¿æ—¥å¿—ç­‰å…ˆè¿›ç‰¹æ€§ã€‚
é€šè¿‡è‡ªåŠ¨ç›‘æ§å‰ç«¯é”™è¯¯ï¼Œåœ¨é”™è¯¯å‘ç”Ÿæ—¶ä¸ŠæŠ¥é”™è¯¯çš„å…·ä½“æƒ…å†µï¼ŒååŠ©å¼€å‘è€…å¿«é€Ÿå®šä½é—®é¢˜ã€‚

#### ä¼˜åŠ¿

- å®Œå…¨åŸºäº Node çš„æµ·é‡æ•°æ®å¤„ç†ä¸­é—´ä»¶ï¼Œé’ˆå¯¹æµ·é‡æ•°æ®è¿›è¡Œå¤šç»´åº¦çš„åˆ†æï¼Œå¯¹äºå‰ç«¯å¼€å‘è€…ååˆ†å‹å¥½ã€‚

- è°ƒç”¨æ–¹ä¾¿ï¼Œåªéœ€åœ¨å…¨å±€åˆå§‹åŒ–aegiså®ä¾‹ï¼Œå°†ä¼šç›‘å¬æ‰€æœ‰çš„ API è¯·æ±‚ï¼Œå¹¶æŠŠå“åº”å†…å®¹å…¨é‡ä¸ŠæŠ¥è‡³åç«¯æœåŠ¡

- åœ¨ä½¿ç”¨ aegis æ—¶æ— éœ€åœ¨ä¸šåŠ¡ä»£ç ä¸­æ‰“ç‚¹æˆ–è€…åšä»»ä½•å…¶ä»–æ“ä½œï¼Œå¯ä»¥åšåˆ°ä¸ä¸šåŠ¡ä»£ç å……åˆ†è§£è€¦ã€‚

- å½“å¼€å¯èµ„æºæµ‹é€Ÿæ—¶ï¼Œaegis å°†ä¼šè‡ªåŠ¨ç›‘å¬é¡µé¢èµ„æºåŠ è½½æƒ…å†µï¼ˆè€—è´¹æ—¶é•¿ã€æˆåŠŸç‡ç­‰ï¼‰ï¼Œå¹¶åœ¨ä¸å½±å“å‰ç«¯æ€§èƒ½çš„å‰æä¸‹æ”¶é›†å‰ç«¯çš„æ€§èƒ½æ•°æ®ï¼Œ
å¿«é€Ÿå®šä½æ€§èƒ½çŸ­æ¿ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

- å½“å‰ç‰ˆæœ¬çš„aegisçš„æ•°æ®é‡‡ç”¨ç¦»çº¿è®¡ç®—çš„æ–¹å¼ã€‚ä¸ºäº†æé«˜æ•°æ®çš„å®æ•ˆæ€§ï¼Œå°†ç¦»çº¿è®¡ç®—çš„äº‹ä»¶ç²’åº¦ç¼©å‡åˆ°åˆ†é’Ÿçº§åˆ«ï¼Œèƒ½å¤Ÿæä¾›çŸ­æ—¶çš„æ•°æ®ï¼Œ
å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå“åº”é—®é¢˜ã€‚å¦å¤–ï¼Œä¹Ÿæä¾›æŒ‰å¤©çš„ç»Ÿè®¡æ•°æ®ï¼Œå¸®åŠ©å¼€å‘è€…æŠŠæ§å¤§ç›˜ï¼ŒæŒæ¡å…¨å±€è§†è§’ã€‚

  ![image](assets/aegis.png)

- ç›®å‰ aegis å¹³å‡æ¯å¤©ä¸ºç”¨æˆ·å¤„ç†çº¦8åƒä¸‡æ¬¡pväº‹ä»¶å’Œ8åƒä¸‡æ¡æ—¥å¿—ä»¥åŠ1äº¿å¤šæ¡æµ‹é€Ÿæ•°æ®ã€‚å•æœº TPS ä¸º 5K å·¦å³ï¼ŒæœåŠ¡å™¨æ”¯æŒå¼¹æ€§æ‰©å®¹ï¼Œ
å³ä½¿ä¸šåŠ¡æ‰©å¼ ä¹Ÿå¯ä»¥ç»´æŒè‰¯å¥½çš„é²æ£’æ€§ã€‚

- Aegis ç›®å‰æä¾›åŒ…æ‹¬ç›‘æ§ã€å‘Šè­¦ã€æ—¥æŠ¥ã€æŠ¥è¡¨ã€ç™½åå•é…ç½®ã€æ•°æ®æŸ¥è¯¢ç­‰å¼€å‘è€…æœåŠ¡ï¼Œä¸ä¼ä¸šå¾®ä¿¡ã€é‚®ä»¶ç³»ç»Ÿæ‰“é€šï¼Œæä¾›åŠæ—¶ã€å¿«é€Ÿçš„æ¶ˆæ¯åé¦ˆã€‚
åŒæ—¶æä¾›aegiså¼€å‘è€…å¹³å°(https://aegis.ivweb.io)ï¼Œæ˜¯ä¸“ä¸ºå¼€å‘è€…è®¾è®¡çš„ä¸€ç«™å¼é¡¹ç›®å‘¨æœŸç®¡ç†ã€é¡¹ç›®ç›‘æ§å¹³å°ï¼Œåœ¨æ­¤å®Œæˆé¡¹ç›®ç”³è¯·å¹¶æ¥å…¥å‰ç«¯SDKä¹‹åï¼Œ
å³å¯å¿«é€ŸæŸ¥çœ‹ç›¸å…³é¡¹ç›®æ•°æ®ä¿¡æ¯ã€‚å¹³å°ä»å¼€å‘è€…è§’åº¦å‡ºå‘ï¼Œèšç„¦äºå‘ç°é—®é¢˜å’Œæé«˜æ•ˆç‡ï¼Œç”¨é¡ºåº”ç›´è§‰çš„äº¤äº’åŠç›´è§‚çš„å›¾è¡¨ï¼Œ
å¸®åŠ©å¼€å‘è€…æ´æ‚‰å­˜åœ¨äºæ•°æ®èƒŒåçš„æœªçŸ¥ã€‚

#### 5.4.1 ä½¿ç”¨demo

##### åˆå§‹åŒ–

æ‰“å¼€å…¨å±€å¼€å…³

åœ¨config.jsä¸­é…ç½®

```javascript
config.logReport = true
```

åˆå§‹åŒ–aegiså®ä¾‹

```javascript
const aegis = new Aegis({
    id: 0, // åœ¨ aegis.ivweb.io ç”³è¯·åˆ°çš„ é¡¹ç›®id
    reportApiSpeed: true,
    reportAssetSpeed: true
})
```

å°†reportApiSpeedå’ŒreportAssetSpeedé…ç½®ä¸ºtrueæ—¶ï¼ŒAegis å°†ä¼šè‡ªåŠ¨æ”¶é›†é¡µé¢çš„APIã€é™æ€èµ„æºè¯·æ±‚çŠ¶å†µï¼Œå¹¶ä¸ŠæŠ¥è‡³ Aegis åç«¯æœåŠ¡ã€‚


#### 5.4.2 åˆ†çº§ä¸ŠæŠ¥

###### infoçº§åˆ«ä¸ŠæŠ¥

```javascript
this.$aegis.logI('aegisæ™®é€šæ—¥å¿—ä¸ŠæŠ¥', report)
```

ä¸ŠæŠ¥info ç­‰çº§çš„æ—¥å¿—ï¼Œä¸ä¼šå½±å“ Aegis è¯„åˆ†ï¼Œä¹Ÿä¸ä¼šè§¦å‘ Aegis å‘Šè­¦ã€‚éå¸¸é€‚åˆä¸ŠæŠ¥å…³é”®è·¯å¾„ä¿¡æ¯ï¼Œå½“é—®é¢˜å‘ç”Ÿæ—¶ï¼Œå¯ä»¥é…åˆå¿«é€Ÿå®šä½å¤ç°è·¯å¾„ã€‚

###### errorçº§åˆ«ä¸ŠæŠ¥

```javascript
this.$aegis.logE('aegiså¼‚å¸¸æ—¥å¿—ä¸ŠæŠ¥', report)
```

ä¸ŠæŠ¥errorç­‰çº§çš„æ—¥å¿—ï¼Œå¾€å¾€æ„å‘³ç€é¡µé¢å‡ºç°äº†é”™è¯¯ï¼Œå½“ä¸ŠæŠ¥çš„ error æ—¥å¿—è¾¾åˆ°é˜ˆå€¼æ—¶ï¼ŒAegis å°†ä¼šè¿›è¡Œå‘Šè­¦ï¼Œå¸®åŠ©å¼€å‘è€…å°½æ—©å‘ç°é—®é¢˜ã€‚å¦å¤–ï¼ŒAegis æ¯å¤©éƒ½ä¼šç»™æ‰€æœ‰é¡¹ç›®æ‰“åˆ†ï¼Œä¸ŠæŠ¥çš„ error æ—¥å¿—æ•°é‡æ˜¯ä¸€ä¸ªå…³é”®æŒ‡æ ‡ã€‚

###### ä¸ŠæŠ¥æµ‹é€Ÿæ—¥å¿—

```javascript
this.$aegis.report('www.test.com', report)
```

ä¸ŠæŠ¥æµ‹é€Ÿæ—¥å¿—,å…¶ä¸­www.test.comæ›¿æ¢æˆé¡¹ç›®ä¸­éœ€è¦ä¸ŠæŠ¥çš„é“¾æ¥

æ›´å¤šä¿¡æ¯ï¼Œå¯é˜…è¯»aegiså®˜ç½‘ï¼š[http://aegis.oa.com](http://aegis.oa.com "http://aegis.oa.com")
<br>

#### 5.5 å‰åç«¯åˆ†ç¦» â€”â€” mockæ”¯æŒ

æˆ‘ä»¬æä¾›äº†ï¼Œä½¿ç”¨åœ¨çº¿mock/æœ¬åœ°mockï¼Œä¸¤ç§mockæ–¹å¼ï¼Œä½ å¯ä»¥æŒ‰éœ€é€‰æ‹©ã€‚

å¼€å§‹ä½¿ç”¨å‰ï¼Œè¯·åœ¨ config.js ä¸­è®¾ç½® config.mock = 'åœ¨çº¿mockåŸŸååœ°å€/127.0.0.1:3001'ã€‚
ï¼ˆæˆ‘ä»¬æä¾›çš„æœ¬åœ°mockï¼Œé»˜è®¤å¯åŠ¨åœ¨3001ç«¯å£ï¼‰

<br>

#### 5.5.1 åœ¨çº¿mock

ã€é…ç½®Demoã€‘

```javascript
// config.js
config.mock = 'https://www.fastmock.site/mock/5804566cbf92cb32bf29b622fdfe6138/word'
```

æˆ‘ä»¬ä»¥ä½¿ç”¨ fastmock ä¸ºä¾‹ï¼Œmockäº†è„šæ‰‹æ¶çš„demoæ•°æ®ã€‚
fastmock å®˜ç½‘ä¼ é€é—¨ï¼š[https://www.fastmock.site](https://www.fastmock.site/#/)

<br>

#### 5.5.2 æœ¬åœ°mock

ã€é…ç½®Demoã€‘

```javascript
// config.js
config.mock = 'http://127.0.0.1:3001'
```

ã€è¯´æ˜ã€‘
æœ¬åœ°mockï¼Œä½¿ç”¨json-serverã€‚

ã€mockç›®å½•ç»“æ„ã€‘

```javascript
â”œâ”€â”€ data                    // å­˜æ”¾mockæ•°æ®
|  â”œâ”€â”€ fail                  // æ¨¡æ‹Ÿè°ƒç”¨å¤±è´¥çš„mockæ•°æ®
|  |  â””â”€â”€ demo1
|  |     â”œâ”€â”€ edit.json
|  |     â””â”€â”€ list.json
|  â””â”€â”€ success           // æ¨¡æ‹Ÿè°ƒç”¨æˆåŠŸçš„mockæ•°æ®
|     â””â”€â”€ demo1
|        â”œâ”€â”€ edit.json
|        â””â”€â”€ list.json
â”œâ”€â”€ db.js                    // ç”¨äºç”Ÿæˆmockæ•°æ®ç»“æ„
â”œâ”€â”€ mock-server.js      // æœåŠ¡å¯åŠ¨å…¥å£
```

ã€ä½¿ç”¨æ–¹å¼ã€‘

**step1ï¼šæ ¹æ®æ¥å£ url å±‚çº§ï¼Œåˆ›å»º mock ç”¨ json æ–‡ä»¶**
ä¾‹å¦‚ï¼šæ¥å£ url ä¸º /demo1/list
åˆ›å»ºæ¨¡æ‹Ÿè¯·æ±‚æˆåŠŸçš„mockæ–‡ä»¶ï¼š/mock/data/success**/demo1/list.json**
åˆ›å»ºæ¨¡æ‹Ÿè¯·æ±‚å¤±è´¥çš„mockæ–‡ä»¶ï¼š/mock/data/fail**/demo1/list.json**

**step2ï¼šç»Ÿä¸€åœ¨ api.js è¿›è¡Œæ¥å£é…ç½®**
æ¨¡æ‹Ÿè¯·æ±‚æˆåŠŸï¼Œç›´æ¥ä½¿ç”¨çœŸå®æ¥å£ï¼šconst API = { list: '/demo1/list' }
æ¨¡æ‹Ÿè¯·æ±‚å¤±è´¥ï¼Œæ”¹é€ çœŸå®æ¥å£ä¸ºï¼šconst API = { list: '**/fail**/demo1/list' }

**step3ï¼šé¡µé¢ä¸­ä½¿ç”¨çœŸå®çš„æ¥å£è¯·æ±‚é€»è¾‘**

```javascript
import $api from '@/model/api.js'
this.$get($api.list).then(res => { console.log('res:', res) })
```

<br>

å…³äºjson-serverçš„å…·ä½“è®¾è®¡æ–¹æ¡ˆï¼Œè¯¦è§ï¼š[https://www.jianshu.com/p/2b18352b49d1](https://www.jianshu.com/p/2b18352b49d1)

<br>

#### 5.6 å®ç”¨å·¥å…·

#### 5.6.1 é¡µé¢åˆ›å»ºï¼špageCreate

ã€ä½¿ç”¨æ–¹å¼ã€‘

```shell
yarn page
```

![image](assets/page_create_1.png)

<br>

æ•ˆæœå¦‚å›¾ï¼š

![image](assets/page_create_2.png)

<br>

#### 5.6.2 è·¯ç”±è‡ªåŠ¨ç”Ÿæˆï¼šrouteCreate

ã€ä½¿ç”¨æ–¹å¼ã€‘

```shell
yarn route
```

![image](assets/route_create.png)

æˆ‘ä»¬æ”¯æŒå…¨è¦†ç›–å¼è·¯ç”±åˆ›å»ºã€é™„åŠ å¼è·¯ç”±åˆ›å»ºï¼Œä¸¤ç§é€‰æ‹©ã€‚

<br>

#### 5.7 é™æ€èµ„æºç®¡ç†
#### 5.7.1 å…¬å…±åº“

æˆ‘ä»¬å¯¹é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„å…¬å…±åº“ï¼Œè¿›è¡Œäº† webpack çš„ externals åŒ–ã€‚
ä½¿ç”¨ cdn èµ„æºå¼•å…¥è¿™äº›åº“ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°é¡¹ç›®æ‰“åŒ…åçš„ä»£ç ä½“ç§¯ã€‚

å¦‚æœä½ æ·»åŠ äº†é¢å¤–çš„å…¬å…±åº“ï¼Œå¹¶ä¸”ä¹Ÿå¸Œæœ›ä½¿ç”¨cdnèµ„æºå¼•å…¥ï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬æ‰“åŒ…åˆ°é¡¹ç›®ä»£ç ä¸­ï¼Œé‚£ä¹ˆä½ åº”è¯¥åœ¨ config.js ä¸­è¿›è¡Œç›¸åº”çš„é…ç½®ï¼Œä¿®æ”¹ externals å±æ€§ã€‚

æˆ‘ä»¬å†…ç½®çš„ externals çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```javascript
// ç‰ˆæœ¬åº“å¤–éƒ¨å¼•å…¥æ–‡ä»¶è·¯å¾„
config.externals = [
	{
		path: '/vue/2.6.10/vue.js',
		packageName: 'vue',
		variableName: 'Vue'
	},
	{
		path: '/vuex/3.1.2/vuex.js',
		packageName: 'vuex',
		variableName: 'Vuex'
	},
	{
		path: '/element-ui/2.12.0/theme-chalk/index.css'
	}
]
```

æ‰€ç”¨ cdn èµ„æºï¼Œå‡æ¥è‡ª [https://lib.baomitu.com](https://lib.baomitu.com "https://lib.baomitu.com")

æ–¹ä¾¿èµ·è§ï¼Œä½ éœ€è¦çš„å…¬å…±åº“ï¼Œè®°å¾—ä¹Ÿå»è¿™é‡ŒæŸ¥æ‰¾å“¦ ğŸ˜‰

<br>

#### 5.7.2 å›¾ç‰‡ä¸å…¬å…±æ ·å¼

pngå›¾ç‰‡ã€svgå›¾ç‰‡ã€common lessæ–‡ä»¶ï¼Œå‡å­˜æ”¾äº assets æ–‡ä»¶å¤¹ã€‚

```javascript
â”œâ”€â”€ assets
|  â”œâ”€â”€ css                       // å…¬å…± css æ–‡ä»¶
|  |  â”œâ”€â”€ color.less         // å½“å‰é¡¹ç›®å„ç§è®¾è®¡é¢œè‰²å®šä¹‰
|  |  â””â”€â”€ u-demo.less     // ä¸šåŠ¡ç›¸å…³çš„å…¬å…±æ ·å¼ç¤ºä¾‹
|  â”œâ”€â”€ icon                     // å­˜æ”¾æ‰€æœ‰ svg æ–‡ä»¶
|  |  â”œâ”€â”€ clock.svg          // svg ç¤ºä¾‹
|  |  â””â”€â”€ gear.svg          // svg ç¤ºä¾‹
|  â”œâ”€â”€ image                  // å­˜æ”¾æ‰€æœ‰pngã€jpgç­‰å¤§å›¾
|  |  â””â”€â”€ logo.png         // png å›¾ç‰‡ç¤ºä¾‹
|  â””â”€â”€ index.js              // é™æ€èµ„æºï¼ˆsvg+cssï¼‰å¼•ç”¨å…¥å£
```
main.js å¼•å…¥ assets/index.jsï¼Œä»è€Œä½¿é€šç”¨æ ·å¼å…¨å±€ç”Ÿæ•ˆã€svgå›¾æ ‡å…¨å±€å¯ç”¨ã€‚

<br>

#### 5.7.3 æ‰“åŒ…åçš„é™æ€èµ„æºä¸Šä¼ cos

æˆ‘ä»¬é»˜è®¤æ”¯æŒè…¾è®¯äº‘å¯¹è±¡ï¼ˆcosï¼‰å­˜å‚¨ã€‚

ã€ä½¿ç”¨æ–¹å¼ã€‘
é…ç½®config.jsï¼š

```javascript
const $urlJoin = require('url-join')
// ä½¿ç”¨ COS çš„åŸŸåï¼Œä»¥//å¼€å¤´ï¼Œè‡ªåŠ¨åŒ¹é…ç«™ç‚¹åè®®
config.cdnBase = '//cdn.xx.yy.com'
// COS ä¸Šä¼ çš„è·¯å¾„
config.uploadUrl = '/2019/test-project'
config.cdnRoot = $urlJoin(config.cdnBase, config.uploadUrl)
// COS ä¸Šä¼ é…ç½®æ¨¡æ¿
config.uploadConfig = {
	// åœ¨è…¾è®¯äº‘ç”³è¯·çš„ AppId
	AppId: '',
	// é…ç½®è…¾è®¯äº‘ COS æœåŠ¡æ‰€éœ€çš„ SecretId
	SecretId: '',
	// é…ç½®è…¾è®¯äº‘ COS æœåŠ¡æ‰€éœ€çš„ SecretKey
	SecretKey: '',
	// COSæœåŠ¡é…ç½®çš„å­˜å‚¨æ¡¶åç§°
	Bucket: '',
	// åœ°åŸŸåç§°
	Region: '',
	// ä¸Šä¼ cdnçš„è·¯å¾„ã€‚æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°è¿™ä¸ªè·¯å¾„ä¸‹
	prefix: config.uploadUrl
}
```

é…ç½® vue.config.jsï¼ˆé»˜è®¤å·²é…ç½®ï¼‰ï¼š

```javascript
// ä½¿ç”¨coså­˜å‚¨çš„é™æ€èµ„æºå¼•ç”¨è·¯å¾„
const publicPath = process.env.NODE_ENV === 'production' ? $config.cdnRoot : '';
```

yarn build æ‰“åŒ…åï¼Œæ‰§è¡Œ** yarn upload **ä¸Šä¼ ã€‚

<br>

#### 5.8 å¼€å‘æ”¯æŒ

#### 5.8.1 æ¥å£ç®¡ç† â€”â€” api.js

ä¸ºäº†æ–¹ä¾¿æ¥å£çš„ç®¡ç†ï¼Œæˆ‘ä»¬è®¾è®¡äº†ç»Ÿä¸€çš„æ¥å£ç®¡ç†æ–‡ä»¶ï¼šmodel/api.js

å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```javascript
// ç»Ÿä¸€çš„æ¥å£ç®¡ç†
const API = {
	getUserInfo: '/getUserInfo',
	getList: '/list'
}

// å¦‚æœæ˜¯å¼€å‘æ¨¡å¼ï¼Œä¸ºæ¥å£è·¯å¾„æ‰‹åŠ¨æ·»åŠ devå‰ç¼€ï¼Œç”¨äºproxyä»£ç†åŒ¹é…
if (document.domain.indexOf('.com') === -1) {
	Object.keys(API).forEach(key => {
		API[key] = '/dev' + API[key]
	})
}

export default API

```

æˆ‘ä»¬åœ¨é¡µé¢ä¸­ï¼Œé€šè¿‡å¼•å…¥ APIï¼Œè¯»å– API.getUserInfo æ¥è°ƒç”¨æ¥å£ã€‚

è¿™æ ·çš„è®¾è®¡å¯ä»¥ä¿è¯ï¼Œå½“åå°æ¥å£è·¯å¾„è°ƒæ•´ï¼Œç»Ÿä¸€ä¿®æ”¹ api.jså³å¯ã€‚ä¾¿äºæ¥å£ç»´æŠ¤ã€‚

<br>

#### 5.8.2 å‘½ä»¤è¡Œå¯åŠ¨ï¼Œæ¨¡å¼åŒºåˆ†è®¾è®¡

æˆ‘ä»¬æä¾›äº†ä¸¤ç§å¯åŠ¨æ¨¡å¼ï¼š**å¼€å‘æ¨¡å¼ / è”è°ƒæ¨¡å¼**ã€‚

æ¯ç§æ¨¡å¼å¯åŠ¨ï¼Œéƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆ model/env.js æ–‡ä»¶ï¼Œå¹¶å†™å…¥å½“å‰æ¨¡å¼ä¸‹çš„æ¥å£è°ƒç”¨åŸŸåï¼Œå¦‚ï¼š

```javascript
// @param:domain å¯åŠ¨ååˆ‡æ¢ç¯å¢ƒåç”Ÿæˆçš„åŸŸå
const env = {};
env.domain = "https://www.fastmock.site/mock/cfbff5d79bd9ff49a81e04dde80521e3/admin";
module.exports = env;
```

<br>

ï¼ˆ1ï¼‰å¼€å‘æ¨¡å¼å¯åŠ¨ï¼Œè°ƒç”¨ mock æ¥å£

```shell
yarn dev
```

mock åœ°å€ï¼Œè¯·åœ¨ config.js ä¸­è‡ªè¡Œé…ç½®ï¼š

```javascript
config.mock = 'https://www.fastmock.site/mock/cfbff5d79bd9ff49a81e04dde80521e3/admin'
```

<br>

ï¼ˆ2ï¼‰è”è°ƒæ¨¡å¼å¯åŠ¨

```shell
yarn debug
```

è”è°ƒæœåŠ¡å™¨åœ°å€ï¼Œmock åœ°å€ï¼Œè¯·åœ¨ config.js ä¸­è‡ªè¡Œé…ç½®ï¼š

```javascript
config.debug = 'http://10.12.13.1:8000'
```

<br>

#### 5.8.3 æœ¬åœ°è”è°ƒä»£ç†é…ç½®

å¦‚ä¸Š 5.8.1 æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨åˆ›å»º api.js æ—¶ï¼Œä¼šæ£€æµ‹å½“å‰å¯åŠ¨é¡µé¢çš„åŸŸåã€‚å¦‚æœä¸æ˜¯åœ¨åŒ…å« .com çš„åŸŸåä¸‹å¯åŠ¨ï¼Œåˆ™è®¤ä¸ºæ˜¯å¼€å‘ç¯å¢ƒã€‚æˆ‘ä»¬æ‰‹åŠ¨ä¸ºå¼€å‘ç¯å¢ƒä¸‹çš„æ¥å£éƒ½æ·»åŠ äº† /dev å‰ç¼€ï¼ŒåŒæ—¶ï¼Œåœ¨ vue.config.js ä¸­è¿›è¡Œä»£ç†é…ç½®ï¼Œä»è€Œè§£å†³è”è°ƒåœºæ™¯ä¸‹ï¼Œlocalhost å‘é€çš„è¯·æ±‚ï¼Œè¢«æœåŠ¡å™¨åˆ¤å®šä¸ºè·¨åŸŸï¼Œæ‹’ç»è®¿é—®çš„é—®é¢˜ã€‚

vue.config.js é…ç½®å¦‚ä¸‹ï¼š

```javascript
devServer: {
	port: $config.devServerPort,
	proxy: {
		'/dev': {                            // åŒ¹é…å¸¦æœ‰/dev å‰ç¼€çš„è¯·æ±‚
			target: $env.domain,    // æ ¹æ®å¯åŠ¨æ¨¡å¼ï¼ŒåŠ¨æ€è®¾ç½®ä»£ç†åˆ°çš„ç›®æ ‡åŸŸå
			changeOrigin: true,
			pathRewrite: {
				'^/dev': ''
			},
			logLevel: 'debug'
		}
	}
}
```

<br>

å¦‚æœä½ ä½¿ç”¨çš„å…¬å¸å†…ç½‘ï¼Œè®¿é—®å¤–éƒ¨ç½‘ç«™éœ€è¦èµ°ä»£ç†ã€‚é‚£ä¹ˆï¼Œåœ¨è¿™é‡Œï¼Œä½ å¯èƒ½è¿˜éœ€è¦è¿›è¡Œä¸€ä¸ªé…ç½®ï¼Œæ‰å¯ä»¥æˆåŠŸæ‹¿åˆ°å¦‚ fastmock è¿™æ ·çš„å¤–éƒ¨ç½‘ç«™ï¼Œè¿”å›çš„æ•°æ®ã€‚

```javascript
// vue.config.js
const HttpsProxyAgent = require('https-proxy-agent')
// ã€æ³¨æ„ã€‘è¯·åœ¨æœ¬åœ°ï¼Œè®¾ç½®ç¯å¢ƒå˜é‡ HTTP_PROXY = 'ä½ çš„å…¬å¸å†…ç½‘è®¿é—®å¤–éƒ¨çš„ä»£ç†æœåŠ¡å™¨åœ°å€'
const proxyServer = process.env.HTTP_PROXY;

devServer: {
	port: $config.devServerPort,
	proxy: {
		'/dev': {                            // åŒ¹é…å¸¦æœ‰/dev å‰ç¼€çš„è¯·æ±‚
			target: $env.domain,    // æ ¹æ®å¯åŠ¨æ¨¡å¼ï¼ŒåŠ¨æ€è®¾ç½®ä»£ç†åˆ°çš„ç›®æ ‡åŸŸå
			// è§£å†³å†…ç½‘ä»£ç†é—®é¢˜ã€‚ï¼ˆå¦‚ä¸éœ€è¦ä»£ç†ï¼Œè¯·åˆ é™¤ä»¥ä¸‹agentä»£ç ï¼‰
			agent: new HttpsProxyAgent(proxyServer),
			changeOrigin: true,
			pathRewrite: {
				'^/dev': ''
			},
			logLevel: 'debug'
		}
	}
}
```

<br>

#### 5.9 è§„èŒƒä»£ç 

#### 5.9.1 .eslintrc ä¸ .editorconfig

æˆ‘ä»¬åˆ¶å®šäº†è¿™æ¬¾è„šæ‰‹æ¶é»˜è®¤çš„å¼€å‘è§„èŒƒï¼Œå¹¶ä¸ºå®ƒé…ç½®äº†é…å¥—çš„ .editorconfig æ ¼å¼åŒ–ã€‚å¦‚æœä½ ä½¿ç”¨äº† vscode è¿™æ ·çš„ç¼–è¾‘å™¨ï¼Œå¹¶å®‰è£…äº† editor æ’ä»¶ï¼Œä½ çš„ä»£ç ä¼šæ ¹æ®æˆ‘ä»¬æä¾›çš„ .editorconfig è‡ªåŠ¨æ ¼å¼åŒ–ã€‚
å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å±äºä½ ä»¬å›¢é˜Ÿçš„ä»£ç è§„èŒƒã€‚

<br>

#### 5.9.2 .pre-commit æ£€æŸ¥

ä¸ºäº†ä¿è¯æäº¤ä»£ç çš„è§„èŒƒæ€§ï¼Œæˆ‘ä»¬åœ¨ package.json ä¸­é…ç½®äº† pre-commit æ£€æŸ¥ã€‚åœ¨ä½ æ‰§è¡Œ git commit çš„æ—¶å€™ï¼Œè‡ªåŠ¨æ‰§è¡Œä»£ç è§„èŒƒæ€§æ£€æŸ¥ï¼Œæ£€æŸ¥é€šè¿‡çš„ä»£ç ï¼Œæ‰å¯ä»¥æˆåŠŸæäº¤ï¼Œå¦‚æ­¤ï¼Œè¿›ä¸€æ­¥æ§åˆ¶äº†ä»£ç çš„è§„èŒƒæ€§ã€‚

<br>

## Â· ç®¡ç†ç«¯-reactï¼ˆå¼€å‘ä¸­ï¼‰

## Â· å°ç¨‹åº-åŸç”Ÿï¼ˆå¼€å‘ä¸­ï¼‰

## Â· å°ç¨‹åº-taroï¼ˆå¼€å‘ä¸­ï¼‰

## Â· å°ç¨‹åº-wepyï¼ˆå¼€å‘ä¸­ï¼‰

## Â· ç§»åŠ¨ç«¯-vueï¼ˆå¼€å‘ä¸­ï¼‰

## Â· ç§»åŠ¨ç«¯-reactï¼ˆå¼€å‘ä¸­ï¼‰

## Â· NodeJS-koaï¼ˆå¼€å‘ä¸­ï¼‰

## Â· NodeJS-expressï¼ˆå¼€å‘ä¸­ï¼‰

## Â· ç»„ä»¶å·¥å…·-åŸç”Ÿjsï¼ˆå¼€å‘ä¸­ï¼‰

## Â· ç»„ä»¶å·¥å…·-vueç»„ä»¶ï¼ˆå¼€å‘ä¸­ï¼‰

## Â· ç»„ä»¶å·¥å…·-reactç»„ä»¶ï¼ˆå¼€å‘ä¸­ï¼‰
